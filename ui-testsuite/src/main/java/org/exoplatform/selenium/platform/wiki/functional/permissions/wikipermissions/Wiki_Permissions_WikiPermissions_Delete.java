/**
 * Generated by thuntn at 2014/09/17 15:06:55
 *
 * Copyright (C) 2009 eXo Platform SAS.
 *
 * This is free software; you can redistribute it and/or modify it
 * under the terms of the GNU Lesser General Public License as
 * published by the Free Software Foundation; either version 2.1 of
 * the License, or (at your option) any later version.
 *
 * This software is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this software; if not, write to the Free
 * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA
 * 02110-1301 USA, or see the FSF site: http://www.fsf.org.
 */

package org.exoplatform.selenium.platform.wiki.functional.permissions.wikipermissions;



import static org.exoplatform.selenium.TestLogger.info;

import org.exoplatform.selenium.Button;
import org.exoplatform.selenium.platform.ManageAccount;
import org.exoplatform.selenium.platform.ManageAccount.userType;
import org.exoplatform.selenium.platform.NavigationToolbar;
import org.exoplatform.selenium.platform.PlatformPermission;
import org.exoplatform.selenium.platform.social.ManageMember;
import org.exoplatform.selenium.platform.social.SpaceManagement;
import org.exoplatform.selenium.platform.wiki.BasicAction;
import org.exoplatform.selenium.platform.wiki.Permission;
import org.exoplatform.selenium.platform.wiki.WikiBase;
import org.testng.annotations.*;




/**
 * @author thuntn
 * @date 17/09/2014
 *
 */
public class Wiki_Permissions_WikiPermissions_Delete extends WikiBase{
	ManageAccount magAcc;
	Button button;
	PlatformPermission per;
	NavigationToolbar navTool;
	Permission perWiki;
	BasicAction ba;
	SpaceManagement spMag;
	ManageMember magMem;

	@BeforeMethod
	public void setUpBeforeTest(){
		initSeleniumTest();
		driver.get(baseUrl);
		magAcc = new ManageAccount(driver);
		button = new Button(driver);
		per = new PlatformPermission(driver);
		navTool = new NavigationToolbar(driver, this.plfVersion);
		perWiki = new Permission(driver);
		ba = new BasicAction(driver);
		spMag = new SpaceManagement(driver, this.plfVersion);
		magMem = new ManageMember(driver, this.plfVersion);
		magAcc.signIn(DATA_USER1, DATA_PASS);
		goToWiki();
	}

	@AfterMethod
	public void afterTest(){
		//signOut();
		driver.manage().deleteAllCookies();
		driver.quit();
	}

	/**
	 *<li> Case ID:113636.</li>
	 *<li> Test Case Name: Delete Admin Pages permission for a group.</li>
	 *<li> Pre-Condition: - The Group A has already the permission : Admin Pages in the Wiki Settings
	- Some wiki pages are already created in this space</li>
	 *<li> Post-Condition: </li>
	 *<li> Done with OSs and browsers : </li>
	 *<li> Generated by thuntn at 2014/09/17 15:06:55</li>
	 */
	@Test
	public  void test01_DeleteAdminPagesPermissionForAGroup() {
		info("Test 1: Delete Admin Pages permission for a group");
		String[] userGroup = {"/Development"};
		String title = "Delete permission 113636";
		String space = "space113636";

		spMag.goToAllSpaces();
		spMag.addNewSpace(space, space);
		spMag.goToSpaceMenu("Space Settings");
		click(spMag.ELEMENT_MEMBER_TAB);
		magMem.inviteSingleUser(userType.DEVELOPER);
		goToWikiFromSpace(space);
		
		ba.addBlankWikiPage(title, title, 0);
		perWiki.deleteSpacePermission("*:/spaces/" + space);
		perWiki.addSpacePermission(2, userGroup);
		perWiki.editSpacePermission("/developers", true, true, true, true,2);
		/*Step Number: 1
		 *Step Name: Step 1: Open form to add permission for space
		 *Step Description: 
			- Go to Browse 
			-
			-> Wiki Settings
			- Choose Permission tab
		 *Input Data: 

		 *Expected Outcome: 
			Space Wiki Permissions form appears*/


		/*Step number: 2
		 *Step Name: Step 2: Delete the Admin Pages permission for Group A
		 *Step Description: 
			- Check the Group A permission
			- In the permission table, untick the Admin Pages checkbox of the Group A
			- Click Save 
			-
			-> OK
		 *Input Data: 

		 *Expected Outcome: 
			- Admin Wiki is auto
			-deselected*/

		perWiki.editSpacePermission("/developers", true, true, false, false,2);
		/*Step number: 3
		 *Step Name: Step 3: Check ifdeselected Group A has Admin Pages permission
		 *Step Description: 
			- Log in with a user member of the Group A
			- Go to Wiki of the space.
		 *Input Data: 

		 *Expected Outcome: 
			- The user cannot see Page Permissions from More menu*/ 
		magAcc.userSignIn(userType.DEVELOPER);
		magMem.acceptInvitation(space);
		goToWikiFromSpace(space);
		click(ELEMENT_NODE_WIKI_PAGE.replace("{$node}",title));
		click(ELEMENT_MORE_LINK);
		waitForAndGetElement(ELEMENT_PAGE_INFO_LINK);
		waitForElementNotPresent(ELEMENT_PAGE_PERMISSION_LINK);

		magAcc.userSignIn(userType.ADMIN);
		spMag.goToAllSpaces();
		spMag.deleteSpace(space);
	}



	/**
	 *<li> Case ID:113607.</li>
	 *<li> Test Case Name: Delete Admin Pages permission for a user.</li>
	 *<li> Pre-Condition: </li>
	 *<li> Post-Condition: - The User A has already the permission: Admin Pages in the Wiki Settings
	- Some wiki pages are already created in this space</li>
	 *<li> Done with OSs and browsers : </li>
	 *<li> Generated by thuntn at 2014/09/17 15:06:55</li>
	 */
	@Test
	public  void test02_DeleteAdminPagesPermissionForAUser() {
		info("Test 2: Delete Admin Pages permission for a user");
		String[] user = {"mary"};
		String title = "Delete permission 113607";
		String space = "space113607";

		spMag.goToAllSpaces();
		spMag.addNewSpace(space, space);
		spMag.goToSpaceMenu("Space Settings");
		click(spMag.ELEMENT_MEMBER_TAB);
		magMem.inviteSingleUser(userType.PUBLISHER);
		goToWikiFromSpace(space);
		
		ba.addBlankWikiPage(title, title, 0);
		perWiki.deleteSpacePermission("*:/spaces/" + space);
		perWiki.addSpacePermission(1, user);
		perWiki.editSpacePermission(user[0], true, true, true, true,2);
		/*Step Number: 1
		 *Step Name: Step 1: Open form to add permission for space
		 *Step Description: 
			- Go to Browse 
			-
			-> Wiki Settings
			- Choose Permission tab
		 *Input Data: 

		 *Expected Outcome: 
			Space Wiki Permissions form appears*/


		/*Step number: 2
		 *Step Name: Step 2: Delete Admin Pages permission
		 *Step Description: 
			- Check the User A permission
			- In the permission table, untick the Admin Pages checkbox of the User A
			- Click Save 
			-
			-> OK
		 *Input Data: 

		 *Expected Outcome: 
			- Admin Wiki is auto
			-deselected.*/

		perWiki.editSpacePermission(user[0], true, true, false, false,2);
		/*Step number: 3
		 *Step Name: Step 3: Check if the deselected user A has Admin Pages permission
		 *Step Description: 
			- Login as user A
			- Go to the space 
			-
			-> Wiki
			- Select a wiki page
		 *Input Data: 

		 *Expected Outcome: 
			- The user A cannot see Page Permissions from More menu*/ 

		magAcc.userSignIn(userType.PUBLISHER);
		magMem.acceptInvitation(space);
		goToWikiFromSpace(space);
		click(ELEMENT_NODE_WIKI_PAGE.replace("{$node}",title));
		click(ELEMENT_MORE_LINK);
		waitForAndGetElement(ELEMENT_PAGE_INFO_LINK);
		waitForElementNotPresent(ELEMENT_PAGE_PERMISSION_LINK);

		magAcc.userSignIn(userType.ADMIN);
		spMag.goToAllSpaces();
		spMag.deleteSpace(space);
	}



	/**
	 *<li> Case ID:113637.</li>
	 *<li> Test Case Name: Delete Admin Wiki permission for a group.</li>
	 *<li> Pre-Condition: - The Group A has already the permission: Admin Wiki in the Wiki Settings
	- Some wiki pages are already created in this space</li>
	 *<li> Post-Condition: </li>
	 *<li> Done with OSs and browsers : </li>
	 *<li> Generated by thuntn at 2014/09/17 15:06:55</li>
	 */
	@Test
	public  void test03_DeleteAdminWikiPermissionForAGroup() {
		info("Test 3: Delete Admin Wiki permission for a group");
		String[] user = {"/Platform/Content Management"};
		String title = "Delete permission 113637";
		String space = "space113637";

		spMag.goToAllSpaces();
		spMag.addNewSpace(space, space);
		spMag.goToSpaceMenu("Space Settings");
		click(spMag.ELEMENT_MEMBER_TAB);
		magMem.inviteSingleUser(userType.PUBLISHER);
		goToWikiFromSpace(space);
		
		ba.addBlankWikiPage(title, title, 0);
		perWiki.deleteSpacePermission("*:/spaces/" + space);
		perWiki.addSpacePermission(2, user);
		perWiki.editSpacePermission("/web-contributors", true, true, true, true,2);
		/*Step Number: 1
		 *Step Name: Step 1: Open form to add permission for space
		 *Step Description: 
			- Go to Browse 
			-
			-> Wiki Settings
			- Choose Permission tab
		 *Input Data: 

		 *Expected Outcome: 
			Space Wiki Permissions form appears*/


		/*Step number: 2
		 *Step Name: Step 2: Delete the Admin Wiki permission
		 *Step Description: 
			- Check the Group A permission
			- In the permission table, untick the Admin Wiki checkbox of the Group A
			- Click Save 
			-
			-> OK
		 *Input Data: 

		 *Expected Outcome: 
			- The Admin Wiki checkbox of Group A is unchecked*/
		perWiki.editSpacePermission("/web-contributors", true, true, true, false,2);

		/*Step number: 3
		 *Step Name: Step 3: Check if deselected Group A has Admin Wiki permission
		 *Step Description: 
			- Log in with a user member of the Group A
			- Go to Wiki of the space.
		 *Input Data: 

		 *Expected Outcome: 
			- The user cannot see Wiki Settings from Browse menu*/ 
		magAcc.userSignIn(userType.PUBLISHER);
		magMem.acceptInvitation(space);
		goToWikiFromSpace(space);
		click(ELEMENT_NODE_WIKI_PAGE.replace("{$node}",title));
		click(ELEMENT_BROWSE_LINK);
		waitForAndGetElement(ELEMENT_MY_DRAFT);
		waitForElementNotPresent(ELEMENT_WIKI_SETTING_LINK);
		
		magAcc.userSignIn(userType.ADMIN);
		spMag.goToAllSpaces();
		spMag.deleteSpace(space);
	}



	/**
	 *<li> Case ID:113634.</li>
	 *<li> Test Case Name: Delete Admin Wiki permission for a user.</li>
	 *<li> Pre-Condition: - The User A has already the permission: Admin Wiki in the Wiki Settings
	- Some wiki pages are already created in this space</li>
	 *<li> Post-Condition: </li>
	 *<li> Done with OSs and browsers : </li>
	 *<li> Generated by thuntn at 2014/09/17 15:06:55</li>
	 */
	@Test
	public  void test04_DeleteAdminWikiPermissionForAUser() {
		info("Test 4: Delete Admin Wiki permission for a user");
		String[] user = {"demo"};
		String title = "Delete permission 113638";
		String space = "space113638";

		spMag.goToAllSpaces();
		spMag.addNewSpace(space, space);
		spMag.goToSpaceMenu("Space Settings");
		click(spMag.ELEMENT_MEMBER_TAB);
		magMem.inviteSingleUser(userType.DEVELOPER);
		goToWikiFromSpace(space);
		
		ba.addBlankWikiPage(title, title, 0);
		perWiki.deleteSpacePermission("*:/spaces/" + space);
		perWiki.addSpacePermission(1, user);
		perWiki.editSpacePermission(user[0], true, true, true, true,2);
		/*Step Number: 1
		 *Step Name: Step 1: Open form to add permission for space
		 *Step Description: 
			- Go to Browse 
			-
			-> Wiki Settings
			- Choose Permission tab
		 *Input Data: 

		 *Expected Outcome: 
			Space Wiki Permissions form appears*/


		/*Step number: 2
		 *Step Name: Step 2: Delete the Admin Wiki permission for User A
		 *Step Description: 
			- Check the User A permission
			- In the permission table, untick the Admin Wiki checkbox of the User A
			- Click Save 
			-
			-> OK
		 *Input Data: 

		 *Expected Outcome: 
			- The Admin Wiki checkbox of User A is unchecked*/
		perWiki.editSpacePermission(user[0], true, true, true, false,2);

		/*Step number: 3
		 *Step Name: Step 3: Check if the deselected user A has Admin Wiki permission
		 *Step Description: 
			- Login as user A
			- Go to the space 
			-
			-> Wiki
			- Select a wiki page
		 *Input Data: 

		 *Expected Outcome: 
			- The user A cannot see Wiki Settings from Browse menu*/ 
		magAcc.userSignIn(userType.DEVELOPER);
		magMem.acceptInvitation(space);
		goToWikiFromSpace(space);
		click(ELEMENT_NODE_WIKI_PAGE.replace("{$node}",title));
		click(ELEMENT_BROWSE_LINK);
		waitForAndGetElement(ELEMENT_MY_DRAFT);
		waitForElementNotPresent(ELEMENT_WIKI_SETTING_LINK);
		magAcc.userSignIn(userType.ADMIN);
		spMag.goToAllSpaces();
		spMag.deleteSpace(space);
	}



	/**
	 *<li> Case ID:113638.</li>
	 *<li> Test Case Name: Delete Edit permission for a group.</li>
	 *<li> Pre-Condition: - The Group A has already the permission: Edit Pages in the Wiki Settings
	- Some wiki pages are already created in this space</li>
	 *<li> Post-Condition: </li>
	 *<li> Done with OSs and browsers : </li>
	 *<li> Generated by thuntn at 2014/09/17 15:06:55</li>
	 */
	@Test
	public  void test05_DeleteEditPermissionForAGroup() {
		info("Test 5: Delete Edit permission for a group");
		String[] user = {"/Development"};
		String title = "Delete permission 113638";
		String space = "space113638";
		
		spMag.goToAllSpaces();
		spMag.addNewSpace(space, space);
		spMag.goToSpaceMenu("Space Settings");
		click(spMag.ELEMENT_MEMBER_TAB);
		magMem.inviteSingleUser(userType.DEVELOPER);
		goToWikiFromSpace(space);
		
		ba.addBlankWikiPage(title, title, 0);
		perWiki.deleteSpacePermission("*:/spaces/" + space);
		perWiki.addSpacePermission(2, user);
		perWiki.editSpacePermission("/developers", true, true, true, true,2);
		/*Step Number: 1
		 *Step Name: Step 1: Open form to add permission for space
		 *Step Description: 
			- Go to Browse 
			-
			-> Wiki Settings
			- Choose Permission tab
		 *Input Data: 

		 *Expected Outcome: 
			Space Wiki Permissions form appears*/


		/*Step number: 2
		 *Step Name: Step 2: Delete Edit Pages permission for Group A
		 *Step Description: 
			- Check the Group A permission
			- In the permission table, untick the Edit Pages checkbox of the Group A
			- Click Save 
			-
			-> OK
		 *Input Data: 

		 *Expected Outcome: 
			- Admin Pages and Admin Wiki are auto
			-deselected for Group A (if they are selected before)*/
		perWiki.editSpacePermission("/developers", true, false, false, false,2);

		/*Step number: 3
		 *Step Name: Step 3: Check if the deselected Group A has Edit Pages permission
		 *Step Description: 
			- Log in with a user member of the Group A
			- Go to Wiki of the space.
		 *Input Data: 

		 *Expected Outcome: 
			- The user can view the wiki page but cannot see Edit Page, Add Page; Move Page and Delete Page and Page Permissions from More menu*/ 

		magAcc.userSignIn(userType.DEVELOPER);
		magMem.acceptInvitation(space);
		goToWikiFromSpace(space);
		click(ELEMENT_NODE_WIKI_PAGE.replace("{$node}",title));
		waitForAndGetElement(ELEMENT_MORE_LINK);
		waitForElementNotPresent(ELEMENT_EDIT_PAGE_LINK);
		magAcc.userSignIn(userType.ADMIN);
		spMag.goToAllSpaces();
		spMag.deleteSpace(space);
	}



	/**
	 *<li> Case ID:113606.</li>
	 *<li> Test Case Name: Delete Edit permission for a user.</li>
	 *<li> Pre-Condition: - The User A has already the permission: Edit Pages in the Wiki Settings
	- Some wiki pages are already created in this space</li>
	 *<li> Post-Condition: </li>
	 *<li> Done with OSs and browsers : </li>
	 *<li> Generated by thuntn at 2014/09/17 15:06:55</li>
	 */
	@Test
	public  void test06_DeleteEditPermissionForAUser() {
		info("Test 6: Delete Edit permission for a user");
		String[] user = {"mary"};
		String title = "Delete permission 113606";
		String space = "space113606";
		
		spMag.goToAllSpaces();
		spMag.addNewSpace(space, space);
		spMag.goToSpaceMenu("Space Settings");
		click(spMag.ELEMENT_MEMBER_TAB);
		magMem.inviteSingleUser(userType.PUBLISHER);
		goToWikiFromSpace(space);
		
		ba.addBlankWikiPage(title, title, 0);
		perWiki.deleteSpacePermission("*:/spaces/" + space);
		perWiki.addSpacePermission(1, user);
		perWiki.editSpacePermission(user[0], true, true, true, true,2);
		
		/*Step Number: 1
		 *Step Name: Step 1: Open form to add permission for space
		 *Step Description: 
			- Go to Browse 
			-
			-> Wiki Settings
			- Choose Permission tab
		 *Input Data: 

		 *Expected Outcome: 
			Space Wiki Permissions form appears*/


		/*Step number: 2
		 *Step Name: Step 2: Delete Edit Pages permission for User A
		 *Step Description: 
			- Check the User A permission
			- In the permission table, untick the Edit Pages checkbox of the User A
			- Click Save 
			-
			-> OK
		 *Input Data: 

		 *Expected Outcome: 
			- Admin Pages and Admin Wiki are auto
			-deselected for User A (if they are selectedbefore)*/
		perWiki.editSpacePermission(user[0], true, false, false, false,2);

		/*Step number: 3
		 *Step Name: Step 3: Check if the deselected User A has Edit Pages permission
		 *Step Description: 
			- Login as User A
			- Go to space 
			-
			-> Wiki
			- Select a wiki page
		 *Input Data: 

		 *Expected Outcome: 
			- The user A can view the wiki page but cannot see Edit Page, Add Page; Move Page and Delete Page and Page Permissions from More menu*/ 

		magAcc.userSignIn(userType.PUBLISHER);
		magMem.acceptInvitation(space);
		goToWikiFromSpace(space);
		click(ELEMENT_NODE_WIKI_PAGE.replace("{$node}",title));
		waitForAndGetElement(ELEMENT_MORE_LINK);
		waitForElementNotPresent(ELEMENT_EDIT_PAGE_LINK);
		
		magAcc.userSignIn(userType.ADMIN);
		spMag.goToAllSpaces();
		spMag.deleteSpace(space);
	}



	/**
	 *<li> Case ID:113644.</li>
	 *<li> Test Case Name: Delete permissions for a group.</li>
	 *<li> Pre-Condition: - Group A already has permissions: View Pages or Edit Pages or Admin Pages or Admin Wiki, or some of them, or all these permissions
	- Some wiki pages are already created</li>
	 *<li> Post-Condition: </li>
	 *<li> Done with OSs and browsers : </li>
	 *<li> Generated by thuntn at 2014/09/17 15:06:55</li>
	 */
	@Test
	public  void test07_DeletePermissionsForAGroup() {
		info("Test 7: Delete permissions for a group");
		
		String[] user = {"/Development"};
		String title = "Delete permission 113644";
		String space = "space113644";
		
		spMag.goToAllSpaces();
		spMag.addNewSpace(space, space);
		spMag.goToSpaceMenu("Space Settings");
		click(spMag.ELEMENT_MEMBER_TAB);
		magMem.inviteSingleUser(userType.DEVELOPER);
		goToWikiFromSpace(space);
		
		ba.addBlankWikiPage(title, title, 0);
		perWiki.deleteSpacePermission("*:/spaces/" + space);
		perWiki.addSpacePermission(2, user);
		perWiki.editSpacePermission("/developers", true, true, true, true,2);
		
		/*	Step Number: 1
		 *Step Name: Step 1: Open form to add permission for space
		 *Step Description: 
			- Go to Browse 
			-
			-> Wiki Settings
			- Choose Permission tab
		 *Input Data: 

		 *Expected Outcome: 
			Space Permissions form appears
		*/

		/*Step number: 2
		 *Step Name: Step 2: Delete permission
		 *Step Description: 
			- Check permissions of Group A
			- Click Delete icon corresponding to Group A
		 *Input Data: 

		 *Expected Outcome: 
			Group A with their permissions are removed from Permissions table*/
		perWiki.deleteSpacePermission("/developers");

		/*Step number: 3
		 *Step Name: Step 3: Check if the deleted user has any permission
		 *Step Description: 
			- Login as user member of Group A
			- Go to the space 
			-
			-> Wiki
		 *Input Data: 

		 *Expected Outcome: 
			The user cannot view any wiki page: Page Not Found */
		perWiki.deleteSpacePermission("any");
		magAcc.userSignIn(userType.DEVELOPER);
		magMem.acceptInvitation(space);
		goToWikiFromSpace(space);
		waitForAndGetElement(ELEMENT_PAGE_NOT_FOUND);
		magAcc.userSignIn(userType.ADMIN);
		spMag.goToAllSpaces();
		spMag.deleteSpace(space);
	}



	/**
	 *<li> Case ID:78331.</li>
	 *<li> Test Case Name: Delete permissions for a user.</li>
	 *<li> Pre-Condition: - User A already has permissions: View Pages or Edit Pages or Admin Pages or Admin Wiki, or some of them, or all these permissions
	- Some wiki pages are already created</li>
	 *<li> Post-Condition: </li>
	 *<li> Done with OSs and browsers : </li>
	 *<li> Generated by thuntn at 2014/09/17 15:06:55</li>
	 */
	@Test
	public  void test08_DeletePermissionsForAUser() {
		info("Test 8: Delete permissions for a user");
		String[] user = {"mary"};
		String title = "Delete permission 78331";
		String space = "space78331";
		
		spMag.goToAllSpaces();
		spMag.addNewSpace(space, space);
		spMag.goToSpaceMenu("Space Settings");
		click(spMag.ELEMENT_MEMBER_TAB);
		magMem.inviteSingleUser(userType.PUBLISHER);
		goToWikiFromSpace(space);
		
		ba.addBlankWikiPage(title, title, 0);
		perWiki.deleteSpacePermission("*:/spaces/" + space);
		perWiki.addSpacePermission(1, user);
		perWiki.editSpacePermission(user[0], true, true, true, true,2);
		
		/*Step Number: 1
		 *Step Name: Step 1: Open form to add permission for space
		 *Step Description: 
			- Go to Browse 
			-
			-> Wiki Settings
			- Choose Permission tab
		 *Input Data: 

		 *Expected Outcome: 
			Space Permissions form appears*/


		/*Step number: 2
		 *Step Name: Step 2: Delete permission
		 *Step Description: 
			- Check permissions of User A
			- Click Delete icon corresponding to User A
		 *Input Data: 

		 *Expected Outcome: 
			User A with his permissions are removed from Permissions table*/
		perWiki.deleteSpacePermission(user[0]);

		/*Step number: 3
		 *Step Name: Step 3: Check if the deleted user has any permission
		 *Step Description: 
			- Login as User A
			- Go to the space 
			-
			-> Wiki
		 *Input Data: 

		 *Expected Outcome: 
			User A cannot view any wiki page: Page Not Found*/ 
		magAcc.userSignIn(userType.PUBLISHER);
		magMem.acceptInvitation(space);
		goToWikiFromSpace(space);
		waitForAndGetElement(ELEMENT_PAGE_NOT_FOUND);
		magAcc.userSignIn(userType.ADMIN);
		spMag.goToAllSpaces();
		spMag.deleteSpace(space);
	}



	/**
	 *<li> Case ID:113635.</li>
	 *<li> Test Case Name: Delete View permission for a group.</li>
	 *<li> Pre-Condition: - The Group A has already the permission : View Pages in the Wiki Settings
	- Some wiki pages are already created in this space</li>
	 *<li> Post-Condition: </li>
	 *<li> Done with OSs and browsers : </li>
	 *<li> Generated by thuntn at 2014/09/17 15:06:55</li>
	 */
	@Test
	public  void test09_DeleteViewPermissionForAGroup() {
		info("Test 9: Delete View permission for a group");
		
		String[] user = {"/Platform/Content Management"};
		String title = "Delete permission 113635";
		String space = "space113635";
		
		spMag.goToAllSpaces();
		spMag.addNewSpace(space, space);
		spMag.goToSpaceMenu("Space Settings");
		click(spMag.ELEMENT_MEMBER_TAB);
		magMem.inviteSingleUser(userType.PUBLISHER);
		goToWikiFromSpace(space);
		
		ba.addBlankWikiPage(title, title, 0);
		perWiki.deleteSpacePermission("*:/spaces/" + space);
		perWiki.addSpacePermission(2, user);
		perWiki.editSpacePermission("/web-contributors", true, true, true, true,2);
		
		/*Step Number: 1
		 *Step Name: Step 1: Open form to add permission for space
		 *Step Description: 
			- Go to Browse 
			-
			-> Wiki Settings
			- Choose Permission tab
		 *Input Data: 

		 *Expected Outcome: 
			Space Wiki Permissions form appears*/


		/*Step number: 2
		 *Step Name: Step 2: Delete permission for a Group
		 *Step Description: 
			- Check the Group A permission
			- In the permission table, untick the View Pages checkbox of the Group A
			- Click Save 
			-
			-> OK
		 *Input Data: 

		 *Expected Outcome: 
			- The permission View Pages is unselected(if the group had only the View permission, the group is is auto
			-removed from the Wiki Permissions table)*/
		perWiki.editSpacePermission("/web-contributors", false, false, false, false,2);

		/*Step number: 3
		 *Step Name: Step 3: Check if the deselected group can view the page
		 *Step Description: 
			- Log in with a user member of the Group A
			- Go to Wiki of the space.
		 *Input Data: 

		 *Expected Outcome: 
			- The user cannot view the wiki page: Page Not Found*/ 
		magAcc.userSignIn(userType.PUBLISHER);
		magMem.acceptInvitation(space);
		goToWikiFromSpace(space);
		waitForAndGetElement(ELEMENT_PAGE_NOT_FOUND);
		magAcc.userSignIn(userType.ADMIN);
		spMag.goToAllSpaces();
		spMag.deleteSpace(space);

	}



	/**
	 *<li> Case ID:113605.</li>
	 *<li> Test Case Name: Delete View permission for a user.</li>
	 *<li> Pre-Condition: - The User A has already the permission : View Pages in the Wiki Settings
	- Some wiki pages are already created in this space</li>
	 *<li> Post-Condition: </li>
	 *<li> Done with OSs and browsers : </li>
	 *<li> Generated by thuntn at 2014/09/17 15:06:55</li>
	 */
	@Test
	public  void test10_DeleteViewPermissionForAUser() {
		info("Test 10 Delete View permission for a user");
		
		String[] user = {"mary"};
		String title = "Delete permission 113605";
		String space = "space113605";
		
		spMag.goToAllSpaces();
		spMag.addNewSpace(space, space);
		spMag.goToSpaceMenu("Space Settings");
		click(spMag.ELEMENT_MEMBER_TAB);
		magMem.inviteSingleUser(userType.PUBLISHER);
		goToWikiFromSpace(space);
		
		ba.addBlankWikiPage(title, title, 0);
		perWiki.deleteSpacePermission("*:/spaces/" + space);
		perWiki.addSpacePermission(1, user);
		perWiki.editSpacePermission(user[0], true, true, true, true,2);
		
		/*Step Number: 1
		 *Step Name: Step 1: Open form to add permission for space
		 *Step Description: 
			- Go to Browse 
			-
			-> Wiki Settings
			- Choose Permission tab
		 *Input Data: 

		 *Expected Outcome: 
			Space Wiki Permissions form appears*/


		/*Step number: 2
		 *Step Name: Step 2: Delete permission for a User
		 *Step Description: 
			- Check the User A permission
			- In the permission table, untick the View Pages checkbox of the User A
			- Click Save 
			-
			-> OK
		 *Input Data: 

		 *Expected Outcome: 
			- The permission View Pages is unselected(if the user had only the View permission, he is is auto
			-removed from the Wiki Permissions table)*/
		perWiki.editSpacePermission(user[0], false, false, false, false,2);

		/*Step number: 3
		 *Step Name: Step 3: Check if the deselected user can view the page
		 *Step Description: 
			- Log in as User A
			- Go to Wiki of the space.
		 *Input Data: 

		 *Expected Outcome: 
			- The user cannot view the wiki page: Page Not Found*/ 
		magAcc.userSignIn(userType.PUBLISHER);
		magMem.acceptInvitation(space);
		goToWikiFromSpace(space);
		waitForAndGetElement(ELEMENT_PAGE_NOT_FOUND);
		
		magAcc.userSignIn(userType.ADMIN);
		spMag.goToAllSpaces();
		spMag.deleteSpace(space);

	}

}